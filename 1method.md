# 方法

方法是与类相关的函数，python也允许定义与类不相关的普通全局函数。类的方法定义在类体中，与普通全局函数区别的是，第一个参数必须为对象本身，通常为self。虽然类方法的第一个参数为self，但是用户不需要也不能给该参数传值，事实上，在创建实例时，python会自动将对象实例传递给该参数。python中的self等价于C++中的self指针和C#中的this关键字。虽然没有限制必须命名为self，但这是惯例，这样便于阅读和理解，且集成开发环境IDE也会提供相应支持。

## `__init__`方法（构造函数）和 `__new__`方法

`__new__`是一个类方法，创建对象时调用，返回当前对象的一个实例，一般无需重载。

`__init__`方法即构造函数（构造方法），用于执行类的实例化的初始化工作。创建完对象后调用，初始化当前对象的实例，无返回值。

## `__del__`方法（析构函数）

用于实现销毁类的实例所需的操作，如释放对象占用的非托管资源（如打开的文件、网络资源）。通过del方法，可以强制销毁一个实例对象。

默认情况下，当对象不再被使用时，该方法运行，由于python解释器实现自动垃圾回收，即无法保证什么时候运行该方法。

## 实例方法

一般情况下，类方法的第一个参数为self，这种方法称为实例方法。实例方法对类的某个给定实例进行操作，可以通过self显式地访问该实例。

```python
def 方法名(self,[形参列表])：
	函数体
```

## 类方法（`@classmethod`)

python也允许声明属于类本身的方法。即类方法，类方法不对特定实例进行操作，在类方法中访问实例对象属性会导致错误。类方法通过装饰器 `@classmethod`定义，第一个形式参数必须为类对象本身，通常为cls。

```python
@classmethod
def 类方法名(cls，[形参列表]):
    pass
```

类方法通过类名来访问，也可以通过对象实例来调用。虽然类方法的第一个参数为cls，但是用户不需要也不能给该参数传值，事实上，在创建实例时，python会自动将类对象传递给该参数。

### 静态方法（`staticmethod`）

python也允许声明属于与类的对象实例无关的方法，称为静态方法。静态方法不对特定实例进行操作，在静态方法中访问对象实例会导致错误。静态方法通过 `@staticmethod`来定义：

```python
@staticmethod
def 静态方法名([实参列表]):
    pass
```

静态方法通过类名访问，也可以通过对象实例调用。

## 私有方法和公有方法

与私有属性类似，python约定两个下划线开头但不以两个下划线结束的方法是私有的。其他的为公有方法。

不能直接访问私有方法，但可以在其他方法中访问。

## 特殊方法

以双下划綫开始并结尾的方法称为特殊方法。特殊方法针对对象的某种操作时自动调用。例如创建对象实例时自动调用其 `__init__`方法，a<b时自动调用a的 `__lt__`方法。

| 特殊方法                       | 含义                     |
| ------------------------------ | ------------------------ |
| `__lt__`、 `__add__`等         | 对应运算符<   ， +       |
| `__init__`,`__del__`           | 创建或销毁对象时调用     |
| `__len__`                      | 对应于内置函数len（）    |
| `__setitem__`,`__getitem__`    | 按索引赋值取值           |
| `__repr__(self)`               | 对应于内置函数repr（）   |
| `__str__(self)`                | 对应于内置函数str（）    |
| `__bytes__(self)`              | 对应于内置函数bytes（）  |
| `__format__(self,format_spec)` | 对应于内置函数format（） |
| `__bol__(self)`                | 对应于内置函数bool（）   |
| `__hash__(self)`               | 对应于内置函数hash（）   |
| `__dir__(self)`                | 对应于内置函数dir（）    |

## `__call__`方法和可调用对象（callable）

python类体中可以定义一个特殊的方法：`__call__`。定义了该方法的对象称为可调用对象，即该对象可以像函数一样被调用。相当于重载了（）运算符。

## 方法重载

其它设计语言中方法可以重载，即可以定义多个重名的方法，只要保证方法签名是唯一的。方法签名包括三部分：方法名、参数数量、参数类型。但python本身是动态语言，方法的参数没有声明类型（调用传值时确定参数类型），参数的数量由可选参数和可变参数来控制，故python对象方法不需要重载，定义一个方法即可实现多种调用，从而实现相当于其他语言中的重载功能。

在python类体中，可以定义多个重名的方法，虽然不会报错，但只有最后一个方法有效，所以建议不要定义重名方法。

## 运算符重载

python运算符实际上是通过调用对象的特殊方法实现的。

| 运算符          | 特殊方法                                                     | 含义                     |
| --------------- | ------------------------------------------------------------ | ------------------------ |
| <,<=,==,>,>=,!= | `__lt__`,`__le__`,`__eq__`,`__ge__`,`__gt__`,`__ne__`        | 比较运算符               |
| \|,^,&          | `__or__`,`__ror__`,`__xor__`,`__rxor__`,`__and__`,`__rand__` | 按位或、异或、与         |
| \|=,^=,&=       | `__ior__`,`__ixor__`,`__iand__`                              | 按位复合运算符           |
| <<,>>           | `__lshift__`,`__rlshift__`,`__rshift__`,`__rrshift__`        | 移位运算                 |
| <<=,>>=         | `__ilshift__,irlshift__,__irshift__,__irrshift__`            | 移位复合运算符           |
| +,-             | `__add__,__radd__,__sub__,__rsub__`                          | 加法与减法               |
| +=,-=           | `__iaddr__,__isub__`                                         | 加减复合运算             |
| *,/,%,//        | `__mul__,__rmul__,__truediv__,rtruediv__,__mod__,`<br />`__rmod__,__floordiv__,__rfloordiv__` | 乘法，除法，取余，整数除 |
| *=,/=,%=,//=    | `__imul__,__idiv__,__itruediv__,__imod__,__ifloordiv__`      | 乘除复合运算             |
| +x,-x           | `__pos__,__neg__`                                            | 正负号                   |
| ~x              | `__invert__`                                                 | 按位翻转                 |
| `**,**=`        | `__pow__,__rpow__,__ipow__`                                  | 指数运算                 |



















